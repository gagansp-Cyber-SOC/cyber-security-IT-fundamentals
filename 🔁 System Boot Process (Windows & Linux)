# ğŸ” System Boot Process (Windows & Linux)

## ğŸ”¹ What

The boot process is the sequence from **power on â†’ OS loaded**
It initializes firmware, loads the bootloader, kernel, drivers, and startup services

Attackers target this stage to gain **early, stealthy persistence**

---

## ğŸ“ Where to check

* Startup configuration
* Bootloaders
* Drivers loaded at boot
* Startup services

---

## ğŸ” How to check

### Windows

```cmd
bcdedit
msconfig
```

Event Viewer

* System logs

### Linux

```bash
dmesg
journalctl -b
```

---

## â“ Why SOC checks

* Bootkits run **before security tools**
* Kernel drivers load during boot
* Persistence that survives reboot

---

## ğŸ“ Important paths

**Windows**

```
C:\Windows\System32\
C:\Windows\System32\drivers\
```

**Linux**

```
/boot/
/lib/modules/
/etc/systemd/
```

---

## ğŸ“„ Sample logs

**Windows**

```
Event ID 12 â€“ System started
Event ID 219 â€“ Driver failed to load
```

**Linux**

```
kernel: loading module xyz
```

---

## ğŸ§° 3rd-party tools

* Sysinternals Autoruns
* EDR boot telemetry
* OSQuery

---

# ğŸŒ± Environment Variables

## ğŸ”¹ What

Environment variables are key-value pairs that control how applications and the OS behave
Examples: `PATH`, `TEMP`, `HOME`

---

## ğŸ“ Where to check

* User environment
* System environment
* Application execution context

---

## ğŸ” How to check

### Windows

```cmd
set
```

System Properties â†’ Environment Variables

### Linux

```bash
env
printenv
```

---

## â“ Why SOC checks

* PATH hijacking
* DLL search order abuse
* Malware redirects execution to malicious binaries

---

## ğŸ“ Common abuse locations

**Windows**

```
C:\Users\<user>\AppData\
C:\Temp\
```

**Linux**

```
/tmp/
/home/<user>/
```

---

## ğŸ“„ Sample log

**Windows â€“ Event ID 4688**

```
Process started with modified PATH
```

(Usually detected via EDR, not native logs)

---

## ğŸ§° 3rd-party tools

* EDR behavior analytics
* OSQuery
* Process Explorer

---

# ğŸ” Permissions and Ownership

## ğŸ”¹ What

Permissions define **who can read, write, or execute** files and services
Ownership defines **who controls permission changes**

---

## ğŸ“ Where to check

* Files and folders
* Services
* Scheduled tasks
* System binaries

---

## ğŸ” How to check

### Windows

```cmd
icacls file.exe
```

### Linux

```bash
ls -l
stat file
```

---

## â“ Why SOC checks

* Weak permissions = privilege escalation
* Writable system files = persistence
* World-writable binaries = high risk

---

## ğŸ“ High-risk paths

**Windows**

```
C:\Users\<user>\AppData\
C:\ProgramData\
```

**Linux**

```
/tmp/
/usr/bin/
/etc/
```

---

## ğŸ“„ Sample logs

**Windows â€“ Event ID 4670**

```
Permissions on an object were changed
```

**Linux**

```
chmod changed on /usr/bin/*
```

---

## ğŸ§° 3rd-party tools

* EDR permission monitoring
* OSQuery
* Auditd

---

# ğŸ§¾ Registry Basics (Windows)

## ğŸ”¹ What

The Windows Registry is a centralized database that stores:

* System configuration
* Startup entries
* Services
* User settings

It is a **primary persistence target**

---

## ğŸ“ Where to check

* Startup keys
* Services
* Policy changes

---

## ğŸ” How to check

```cmd
regedit
```

---

## ğŸ“ Critical registry paths

```
HKLM\Software\Microsoft\Windows\CurrentVersion\Run
HKCU\Software\Microsoft\Windows\CurrentVersion\Run
HKLM\SYSTEM\CurrentControlSet\Services
HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce
```

---

## â“ Why SOC checks

* Malware auto-start
* Hidden persistence
* Living-off-the-land techniques

---

## ğŸ“„ Sample logs

**Windows â€“ Event ID 4657**

```
A registry value was modified
Object Name: Run\Updater
```

---

## ğŸ§° 3rd-party tools

* Sysinternals Autoruns
* EDR persistence detection
* OSQuery

---

## ğŸ§  Final SOC Mindset (OS Fundamentals)

Most attacks follow this chain:

**File write â†’ Process â†’ Service / Registry / Boot â†’ Persistence**

If you understand:

* Boot
* Environment
* Permissions
* Registry

You can **reconstruct almost any endpoint attack timeline**
