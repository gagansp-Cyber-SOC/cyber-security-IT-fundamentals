

# ğŸ–¥ï¸ Operating Systems â€“ Deep Fundamentals

---

## 1ï¸âƒ£ What is an Operating System (OS)

### ğŸ”¹ What

An OS is the core software that:

* Manages hardware (CPU, memory, disk)
* Runs applications
* Handles users, permissions, and processes

Examples:

* Windows
* Linux
* macOS

---

### ğŸ”¹ Where to check

* Endpoint
* Server
* VM
* Cloud instances

---

### ğŸ”¹ How to check

**Windows**

```cmd
winver
systeminfo
```

**Linux**

```bash
uname -a
cat /etc/os-release
```

---

### ğŸ”¹ Why SOC checks this

* OS decides **log locations**
* OS version decides **vulnerabilities**
* Attack techniques differ per OS

---

### ğŸ”¹ Sample log relevance

* Windows Event Logs
* Linux `/var/log/*`

---

## 2ï¸âƒ£ Windows vs Linux vs macOS

### ğŸ”¹ What

| OS      | Used For               |
| ------- | ---------------------- |
| Windows | Endpoints, AD, servers |
| Linux   | Servers, cloud, infra  |
| macOS   | Developer endpoints    |

---

### ğŸ”¹ Where to check

* Endpoints
* Servers
* Cloud VMs

---

### ğŸ”¹ How to check

**Windows**

```cmd
systeminfo | findstr OS
```

**Linux**

```bash
lsb_release -a
```

---

### ğŸ”¹ Why SOC cares

* Windows â†’ AD attacks, malware
* Linux â†’ SSH brute force, crypto miners
* macOS â†’ Less common but rising attacks

---

### ğŸ”¹ Example

* Brute force on SSH â†’ Linux
* LSASS dumping â†’ Windows

---

## 3ï¸âƒ£ User Mode vs Kernel Mode

### ğŸ”¹ What

* **User Mode** â†’ Applications run here
* **Kernel Mode** â†’ OS core, drivers

---

### ğŸ”¹ Where to check

* Process behavior
* Driver activity
* Crash logs

---

### ğŸ”¹ How to check

**Windows**

* Task Manager â†’ Details
* Driver list

**Linux**

```bash
lsmod
```

---

### ğŸ”¹ Why SOC checks

* Kernel-level malware = HIGH impact
* Rootkits operate in kernel mode

---

### ğŸ”¹ Example

* Normal app â†’ user mode
* Malicious driver â†’ kernel mode

---

## 4ï¸âƒ£ Processes vs Services

### ğŸ”¹ What

* **Process** â†’ Running program
* **Service** â†’ Background process (persistent)

---

### ğŸ”¹ Where to check

* Endpoints
* Servers

---

### ğŸ”¹ How to check

**Windows**

```cmd
tasklist
services.msc
```

**Linux**

```bash
ps aux
systemctl list-units
```

---

### ğŸ”¹ Why SOC checks

* Malware often runs as a **process**
* Persistence often via **service**

---

### ğŸ”¹ Path

**Windows**

```
C:\Windows\System32\
```

---

### ğŸ”¹ Sample log

**Windows Event ID 4688**

```
A new process has been created
```

---

## 5ï¸âƒ£ Threads

### ğŸ”¹ What

Threads are **smaller execution units** inside a process

---

### ğŸ”¹ Where to check

* Performance issues
* Suspicious behavior

---

### ğŸ”¹ How to check

**Windows**

* Process Explorer (Sysinternals)

**Linux**

```bash
top -H
```

---

### ğŸ”¹ Why SOC checks

* Malware hides inside legitimate processes using threads

---

### ğŸ”¹ 3rd-party

* **Process Explorer**
* **EDR tools**

---

## 6ï¸âƒ£ File Systems (NTFS, FAT32, ext4)

### ğŸ”¹ What

File system defines how data is stored

| FS    | OS      |
| ----- | ------- |
| NTFS  | Windows |
| FAT32 | USB     |
| ext4  | Linux   |

---

### ğŸ”¹ Where to check

* Disk
* External media

---

### ğŸ”¹ How to check

**Windows**

```cmd
fsutil fsinfo volumeinfo c:
```

**Linux**

```bash
df -T
```

---

### ğŸ”¹ Why SOC checks

* NTFS supports permissions and auditing
* FAT32 has **no permissions** â†’ malware risk

---

### ğŸ”¹ Path relevance

* Hidden malicious files
* Alternate Data Streams (NTFS)

---

## 7ï¸âƒ£ System Boot Process

### ğŸ”¹ What

Steps from power-on â†’ OS loaded

---

### ğŸ”¹ Where to check

* Boot logs
* Startup entries

---

### ğŸ”¹ How to check

**Windows**

```cmd
bcdedit
```

**Linux**

```bash
dmesg
```

---

### ğŸ”¹ Why SOC checks

* Bootkits
* Persistence before OS loads

---

### ğŸ”¹ Sample log

* Boot failure
* Unsigned driver loading

---

## 8ï¸âƒ£ Environment Variables

### ğŸ”¹ What

Variables that affect system and apps

Examples:

* PATH
* TEMP

---

### ğŸ”¹ Where to check

* User environment
* System environment

---

### ğŸ”¹ How to check

**Windows**

```cmd
set
```

**Linux**

```bash
env
```

---

### ğŸ”¹ Why SOC checks

* Malware hijacks PATH
* DLL hijacking

---

### ğŸ”¹ Example

Malicious exe placed earlier in PATH

---

## 9ï¸âƒ£ Permissions and Ownership

### ğŸ”¹ What

Defines **who can access what**

---

### ğŸ”¹ Where to check

* Files
* Folders
* Services

---

### ğŸ”¹ How to check

**Windows**

```cmd
icacls file.txt
```

**Linux**

```bash
ls -l
```

---

### ğŸ”¹ Why SOC checks

* Weak permissions = easy privilege escalation

---

### ğŸ”¹ Example

* World-writable binary â†’ privilege abuse

---

## ğŸ”Ÿ Registry Basics (Windows)

### ğŸ”¹ What

Central config database for Windows

---

### ğŸ”¹ Where to check

* Startup entries
* Services
* Policies

---

### ğŸ”¹ How to check

```cmd
regedit
```

---

### ğŸ”¹ Key paths (VERY IMPORTANT)

```
HKLM\Software\Microsoft\Windows\CurrentVersion\Run
HKCU\Software\Microsoft\Windows\CurrentVersion\Run
HKLM\SYSTEM\CurrentControlSet\Services
```

---

### ğŸ”¹ Why SOC checks

* Malware persistence
* Hidden startup entries

---

### ğŸ”¹ Sample log

**Event ID 4657**

```
A registry value was modified
```

---

## ğŸ”¹ 3rd-Party Applications SOC Uses

* Sysinternals Suite
* EDR platforms
* OSQuery
* Autoruns

---

## ğŸ§  Final SOC Mindset

If you understand:

* OS
* Processes
* Permissions
* Logs
* Persistence paths

You can investigate **any alert**, even without tools.

