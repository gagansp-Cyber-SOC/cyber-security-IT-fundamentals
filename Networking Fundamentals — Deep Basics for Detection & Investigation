# ðŸŒ SOC NETWORKING FUNDAMENTALS â€” DEEP BASICS (WHY â€¢ WHAT â€¢ WHERE â€¢ HOW)

> **Audience:** SOC L1â€“L2 (Defensive)
>
> **Goal:** After reading this, you should NOT need Google
>
> **Mindset:** Every network concept answers one question â€” *Is this traffic normal or suspicious?*

---

## ðŸ§± 1ï¸âƒ£ OSI & TCP/IP â€” SOC VIEW (NOT EXAM VIEW)

### ðŸ”¹ WHAT IT IS

A mental model to understand **where** something broke and **what evidence** to look for

OSI = *conceptual layers*
TCP/IP = *what actually runs on the wire*

| OSI Layer | TCP/IP         | SOC Meaning      | What Breaks Here    | Logs You Check  |
| --------- | -------------- | ---------------- | ------------------- | --------------- |
| L7 App    | Application    | User intent      | Phishing, C2, Exfil | Proxy, App, DNS |
| L6â€“L5     | Application    | Session handling | Token abuse         | App logs        |
| L4        | Transport      | Port + protocol  | Scan, brute force   | Firewall, Flow  |
| L3        | Internet       | IP routing       | Lateral movement    | NetFlow         |
| L2        | Network Access | MAC, ARP         | MITM                | Switch logs     |

### ðŸ”¹ WHY SOC CARES

Because **alerts map to layers**

Example

* Port scan â†’ L4
* DNS tunneling â†’ L7
* ARP spoofing â†’ L2

Wrong layer = wrong investigation

### ðŸ”¹ HOW SOC USES IT

Alert says

> "Suspicious outbound connection"

SOC asks

* L3 â†’ Which IP
* L4 â†’ Which port
* L7 â†’ Which protocol / domain

---

## ðŸ”Œ 2ï¸âƒ£ PORTS, PROTOCOLS & SERVICES

### ðŸ”¹ WHAT

* **Port** = Door number
* **Protocol** = Language
* **Service** = Application listening

Example

```
443/TCP â†’ HTTPS â†’ Web service
22/TCP â†’ SSH â†’ Remote admin
3389/TCP â†’ RDP â†’ Windows login
```

### ðŸ”¹ WHY SOC CARES

Ports answer **WHAT service is exposed or abused**

Red flags

* Non-standard ports (SSH on 2222)
* Rare ports (4444, 1337)
* Service mismatch (HTTP over 53)

### ðŸ”¹ WHERE TO CHECK

**Windows**

```
netstat -ano
Get-NetTCPConnection
```

**Linux**

```
ss -tulpn
netstat -plant
```

**Firewall / SIEM fields**

* src_port
* dest_port
* protocol

### ðŸ”¹ SAMPLE LOG (Firewall)

```
SRC=10.0.0.5 DST=185.199.110.153 DPT=4444 PROTO=TCP ACTION=ALLOW
```

SOC thought

* Why port 4444?
* Known C2 port?
* Who initiated?

---

## ðŸŒ 3ï¸âƒ£ DNS â€” MOST ABUSED PROTOCOL

### ðŸ”¹ WHAT

Resolves **name â†’ IP**

### ðŸ”¹ WHY ATTACKERS LOVE IT

* Almost always allowed
* Looks normal
* Works even without internet browsing

### ðŸ”¹ ATTACKER USES

* C2 over DNS
* Data exfil via subdomains
* Domain generation algorithms (DGA)

### ðŸ”¹ WHERE TO LOOK

**Windows**

```
Event ID 22 (DNS Client)
```

**Linux**

```
/var/log/syslog
journalctl -u systemd-resolved
```

**SIEM fields**

* query
* response
* query_length
* domain

### ðŸ”¹ SAMPLE DNS LOG

```
client=10.0.0.8 query=ajd92kd9skd92.malicious.xyz type=A
```

SOC questions

* Random string?
* Repeated pattern?
* Rare domain?

---

## ðŸ§¾ 4ï¸âƒ£ DHCP â€” WHO GOT WHICH IP

### ðŸ”¹ WHAT

Assigns IPs dynamically

### ðŸ”¹ WHY SOC CARES

Identity mapping

* User â†’ Device â†’ IP â†’ Alert

### ðŸ”¹ WHERE TO LOOK

**Windows DHCP**

```
Event ID 10, 11
```

**Linux**

```
/var/log/dhcpd.log
```

### ðŸ”¹ SAMPLE

```
DHCPACK on 10.0.0.25 to 00:50:56:a1:b2:c3
```

SOC use

* Identify device behind alert

---

## ðŸ”„ 5ï¸âƒ£ ARP â€” SILENT KILLER

### ðŸ”¹ WHAT

Maps **IP â†’ MAC**

### ðŸ”¹ WHY SOC CARES

ARP spoofing = MITM

### ðŸ”¹ RED FLAGS

* Same IP, multiple MACs
* Frequent ARP replies

### ðŸ”¹ COMMANDS

**Windows**

```
arp -a
```

**Linux**

```
ip neigh
```

---

## ðŸ›¡ï¸ 6ï¸âƒ£ PROXY, NAT, VPN

### ðŸ”¹ PROXY

Acts on behalf of users

SOC impact

* Masks real destination
* Logs show **URL, user, action**

Sample

```
user=gagan url=drive.google.com action=allowed
```

### ðŸ”¹ NAT

Hides internal IPs

SOC impact

* One public IP â‰  one device

Need NAT logs

### ðŸ”¹ VPN

Encrypted tunnel

SOC focus

* Login time
* Source IP
* Assigned internal IP

Sample

```
user=gagan src_ip=49.x.x.x vpn_ip=10.8.0.12
```

---

## â†”ï¸ 7ï¸âƒ£ EASTâ€“WEST vs NORTHâ€“SOUTH

### ðŸ”¹ WHAT

* Northâ€“South = Internet â†” Org
* Eastâ€“West = Internal â†” Internal

### ðŸ”¹ WHY SOC CARES

* Lateral movement happens Eastâ€“West
* Firewalls often weak internally

### ðŸ”¹ RED FLAGS

* Server talking to many servers
* Workstation scanning subnet

---

## ðŸ“Š 8ï¸âƒ£ NETWORK LOGS & FLOW DATA

### ðŸ”¹ FLOW LOGS SHOW

* Who talked to whom
* When
* How much data

### ðŸ”¹ SAMPLE NETFLOW

```
src=10.0.0.5 dst=45.67.89.10 bytes=234567 duration=360s
```

SOC question

* Why so much data?
* Known destination?

---

## ðŸ§¨ 9ï¸âƒ£ COMMON NETWORK ATTACKS

### ðŸ”¹ PORT SCAN

Indicators

* Many ports
* Same source

Log pattern

```
DPT=21,22,23,80,443
```

### ðŸ”¹ MITM (ARP SPOOF)

Indicators

* Duplicate MACs
* Cert warnings

---

## ðŸ§  FINAL SOC RULE

> **Network traffic is never good or bad by itself**
>
> **Context decides everything**

User + Device + Time + Destination + Volume = Truth

