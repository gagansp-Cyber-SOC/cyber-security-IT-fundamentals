# ðŸ‘¤ SOC IDENTITY & AUTHENTICATION â€” DEEP BASICS (WHY â€¢ WHAT â€¢ WHERE â€¢ HOW)

> **Audience:** SOC L1â€“L2 (Defensive)
>
> **Goal:** Understand identity events the way attackers and SOC analysts see them
>
> **Core Truth:** Most modern breaches start with **identity abuse**, not malware

---

## ðŸ”‘ 1ï¸âƒ£ AUTHENTICATION vs AUTHORIZATION

### ðŸ”¹ WHAT

* **Authentication** â†’ Who are you?
* **Authorization** â†’ What are you allowed to do?

### ðŸ”¹ WHY SOC CARES

Because **successful authentication does NOT mean legitimate access**

Attackers often:

* Authenticate legitimately (stolen creds)
* Abuse authorization (excessive permissions)

### ðŸ”¹ WHERE TO SEE THIS

**Windows Security Logs**

* Auth â†’ Event ID **4624 / 4625**
* AuthZ â†’ Group membership, token privileges

**Cloud IdP**

* Sign-in success
* Role assignment logs

### ðŸ”¹ SAMPLE LOG

```
EventID=4624
User=gagan
LogonType=10
AuthPackage=Negotiate
```

SOC thinking

* Success â‰  safe
* Why LogonType 10 (RDP)?

---

## ðŸ¢ 2ï¸âƒ£ ACTIVE DIRECTORY â€” DEEP FUNDAMENTALS

### ðŸ”¹ WHAT AD REALLY IS

A **centralized identity + trust database**

Stores

* Users
* Groups
* Computers
* Trusts
* Policies

### ðŸ”¹ WHY ATTACKERS TARGET AD

* One account â†’ many systems
* Privilege escalation paths

### ðŸ”¹ CORE COMPONENTS SOC MUST KNOW

| Component | Purpose           | Abuse       |
| --------- | ----------------- | ----------- |
| DC        | Auth authority    | DCSync      |
| LDAP      | Directory queries | Recon       |
| GPO       | Policy control    | Persistence |

### ðŸ”¹ WHERE TO LOOK

**AD Logs (DC)**

```
Windows Logs â†’ Security
```

Important Event IDs

* 4624 / 4625 â†’ Logon
* 4672 â†’ Privileged logon
* 4728 â†’ Added to group
* 4768 / 4769 â†’ Kerberos

---

## ðŸŽ« 3ï¸âƒ£ KERBEROS vs NTLM

### ðŸ”¹ WHAT

* **Kerberos** â†’ Ticket-based (modern)
* **NTLM** â†’ Challenge-response (legacy)

### ðŸ”¹ WHY SOC CARES

NTLM usage today often means:

* Legacy system
* Misconfiguration
* Relay attacks

### ðŸ”¹ ATTACKER ABUSE

* Kerberoasting
* NTLM relay

### ðŸ”¹ WHERE TO SEE

**Kerberos Events**

* 4768 â†’ TGT request
* 4769 â†’ Service ticket

**NTLM**

* Event ID 4776

### ðŸ”¹ SAMPLE

```
4769 ServiceName=HTTP/webserver
```

SOC thought

* Why requesting many tickets?

---

## ðŸ” 4ï¸âƒ£ MFA TYPES & FAILURES

### ðŸ”¹ MFA TYPES

* SMS OTP
* App-based push
* Hardware token
* Biometrics

### ðŸ”¹ WHY SOC CARES

MFA failure patterns reveal attacks

### ðŸ”¹ ATTACK TECHNIQUES

* MFA fatigue
* OTP phishing
* Push bombing

### ðŸ”¹ WHERE TO LOOK

**Cloud IdP Logs**

* MFA challenge
* MFA result

### ðŸ”¹ SAMPLE

```
MFAResult=Denied
Reason=User rejected
```

SOC thinking

* How many rejects?
* Time window?

---

## â˜ï¸ 5ï¸âƒ£ CLOUD IDENTITY â€” IdP & SSO

### ðŸ”¹ WHAT

Identity Provider authenticates users once
SSO grants access to many apps

Examples

* Azure AD
* Okta
* Google Workspace

### ðŸ”¹ WHY SOC CARES

* Cloud identity = primary perimeter
* No network boundary

### ðŸ”¹ WHERE TO LOOK

**IdP Logs**

* Sign-in logs
* Token issuance
* Conditional access

### ðŸ”¹ SAMPLE

```
User=gagan
App=Salesforce
Result=Success
IP=185.x.x.x
```

SOC question

* Known IP?
* Risk flagged?

---

## ðŸ‘‘ 6ï¸âƒ£ PRIVILEGED ACCESS

### ðŸ”¹ WHAT

Accounts with elevated rights

Examples

* Domain Admin
* Global Admin
* Root

### ðŸ”¹ WHY SOC CARES

One privileged account = full compromise

### ðŸ”¹ RED FLAGS

* Privileged login from workstation
* Privilege escalation after hours

### ðŸ”¹ LOGS

* Event ID 4672
* Role assignment logs

---

## ðŸš¨ 7ï¸âƒ£ IDENTITY LOGS & ABUSE PATTERNS

### ðŸ”¹ COMMON ABUSE PATTERNS

| Pattern                 | Meaning          |
| ----------------------- | ---------------- |
| Many failures â†’ success | Password spray   |
| New country login       | Account takeover |
| MFA bypass              | Token theft      |
| Service account login   | Lateral movement |

### ðŸ”¹ CORRELATION IDEA

```
Failed logins â†’ VPN success â†’ Admin group add
```

---

## ðŸ§  FINAL SOC RULE

> **Identity alerts are never isolated**
>
> Always correlate with

* Network
* Endpoint
* Time

