# ğŸ§  User Mode vs Kernel Mode (Deep Fundamentals â€“ SOC View)

---

## ğŸ”¹ What is User Mode

### âœ… What

User Mode is where:

* Regular applications run
* Limited access to system resources
* Crashes do **not** crash the OS

Examples:

* Browsers
* Office apps
* Scripts
* Most third-party software

---

### ğŸ“ Where to check

* Running processes
* Application behavior
* CPU / memory usage

---

### ğŸ” How to check

**Windows**

* Task Manager â†’ Details tab
* Process Explorer (Sysinternals)

**Linux**

```bash
ps aux
top
```

---

### â“ Why SOC checks User Mode

* Malware often **starts** in user mode
* Initial execution happens here
* Easier to detect than kernel threats

---

### ğŸ“ Common paths (user-mode binaries)

**Windows**

```
C:\Program Files\
C:\Program Files (x86)\
C:\Users\<user>\AppData\
```

**Linux**

```
/usr/bin/
/usr/local/bin/
/home/<user>/
```

---

### ğŸ“„ Sample log

**Windows â€“ Event ID 4688**

```
A new process has been created
Process Name: C:\Users\user\AppData\malware.exe
```

---

### ğŸ§° 3rd-party tools

* EDR platforms
* Process Explorer
* OSQuery

---

## ğŸ”¹ What is Kernel Mode

### âš ï¸ What

Kernel Mode is where:

* OS core runs
* Drivers execute
* Full access to hardware and memory

Any crash here can:
âŒ Blue Screen (Windows)
âŒ Kernel panic (Linux)

---

### ğŸ“ Where to check

* Drivers
* Kernel modules
* System crashes

---

### ğŸ” How to check

**Windows**

* Device Manager â†’ Drivers
* `driverquery`
* Sysinternals â†’ Driver View

**Linux**

```bash
lsmod
dmesg
```

---

### â“ Why SOC checks Kernel Mode

* Kernel malware = **maximum privilege**
* Can hide from security tools
* Rootkits and bootkits live here

---

### ğŸ“ Critical paths (kernel components)

**Windows**

```
C:\Windows\System32\drivers\
```

**Linux**

```
/lib/modules/
/boot/
```

---

### ğŸ“„ Sample logs

**Windows**

* Event ID 1001 (BugCheck)
* Event ID 219 (Driver failure)

**Linux**

```bash
dmesg | grep -i error
```

---

### ğŸ§¨ Attacker examples

* Malicious driver signed or exploited
* Rootkit hooking kernel functions
* Bypassing EDR visibility

---

### ğŸ§° 3rd-party tools

* Sysinternals (Process Explorer, Autoruns)
* EDR kernel telemetry
* OSQuery
* Kernel debuggers (advanced)

---

## ğŸ” User Mode vs Kernel Mode (Quick Comparison)

| Area             | User Mode       | Kernel Mode  |
| ---------------- | --------------- | ------------ |
| Privilege        | Limited         | Full         |
| Stability impact | App crash only  | System crash |
| Malware type     | Initial loaders | Rootkits     |
| Detection        | Easier          | Harder       |
| SOC priority     | High            | Critical     |

---

## ğŸ§  SOC Mindset (Very Important)

Most attacks:

1. Start in **user mode**
2. Try to **escalate to kernel mode**
3. Aim to **hide and persist**

If you see:

* Unknown drivers
* Unexpected kernel crashes
* Unsigned kernel modules

â¡ï¸ Treat as **high-severity incident**
